{"version":3,"sources":["create_store.js","apply_middleware.js","function_middleware.js","index.js"],"names":["isFunction","obj","module","exports","createStore","reducer","initialState","extension","Error","every","item","undefined","applyMiddlewares","currentReducer","state","type","payload","subscribers","dispatch","action","oldState","forEach","subscriber","getState","subscribe","cb","push","index","indexOf","splice","composeMiddlewares","middlewares","length","reduce","prev","curr","args","store","middlewareAPI","middleWaresWithCurrentStore","map","middleware","createMiddleware","next","require","applyMiddleware","root","forExport","define","amd","func","redux","window","global"],"mappings":"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","file":"index.js","sourceRoot":"../src/store","sourcesContent":["function isFunction(obj) {\n  return typeof obj === 'function';\n}\n\n/**\n * Фнкция для создания редьюсера\n * @param reducer\n * @param initialState: object|function Может быть объектом начального стора или applay middleware\n * @param extension: object|function Может быть объектом начального стора или applay middleware\n * @return {{dispatch(*=): void, getState: (function(): *), subscribe(*=): *}|Function}\n */\nmodule.exports = function createStore(reducer, initialState, extension) {\n  if (typeof reducer !== 'function') throw new Error('reducer must be function');\n\n  if ([initialState, extension].every(item => isFunction(item))) {\n    throw new Error('can be only one store extension as function');\n  }\n\n  if (isFunction(initialState) && extension === undefined) {\n    const applyMiddlewares = initialState;\n    const preloadState = undefined;\n    return applyMiddlewares(createStore, reducer, preloadState);\n  }\n\n  const currentReducer = reducer;\n  let state = currentReducer(initialState, { type: 'INIT', payload: {} });\n\n  const subscribers = [];\n  return {\n    dispatch(action) {\n      if (typeof action === 'function') {\n        throw new Error('action must be plane object');\n      }\n      const oldState = state;\n\n      state = currentReducer(state, action);\n\n      if (state === oldState) {\n        throw new Error('reducer must return copy of object');\n      }\n\n      subscribers.forEach(subscriber => {\n        subscriber(state);\n      });\n    },\n\n    getState: () => state,\n\n    subscribe(cb) {\n      subscribers.push(cb);\n\n      return () => {\n        const index = subscribers.indexOf(cb);\n\n        if (index >= 0) {\n          subscribers.splice(index, 1);\n        }\n      };\n    },\n  };\n};\n","/**\n * Фнкция для создания цепочки из middlewares\n * @param middlewares bиспользуемые в приложении\n * @return function Вернет функцию которая создаст цепочку\n */\nfunction composeMiddlewares(...middlewares) {\n  if (!middlewares.length) {\n    throw new Error('no pass one middleware');\n  }\n\n  if (middlewares.length === 1) {\n    return middlewares[0];\n  }\n\n  return middlewares.reduce((prev, curr) => (...args) => prev(curr(...args)));\n}\n\n/**\n * Функция для создания цепочки из middlewares,\n * @param middlewares принимает в качестве аргументов middlewares\n * @return {function(*, *=, ...[*]): {dispatch: *, store: *}} Возврщает функцию для стора\n */\nmodule.exports = function applyMiddleware(...middlewares) {\n  /**\n   * Фнкция, которая исполняется непосредственно в сторе\n   * @param createStore функция создания стора\n   * @param reducer\n   * @param args начальное состояние\n   * @return {{dispatch: *, store: *}}\n   */\n  return (createStore, reducer, ...args) => {\n    const store = createStore(reducer, ...args);\n\n    let dispatch = () => {\n      throw new Error('dispatch called too early');\n    };\n\n    const middlewareAPI = {\n      getState: store.getState,\n      dispatch: (action, ...payload) => dispatch(action, ...payload),\n    };\n\n    const middleWaresWithCurrentStore = middlewares.map(middleware => middleware(middlewareAPI));\n\n    dispatch = composeMiddlewares(...middleWaresWithCurrentStore)(store.dispatch);\n\n    return {\n      ...store,\n      dispatch,\n    };\n  };\n};\n","function createMiddleware() {\n  return ({ dispatch, getState }) => next => action => {\n    if (typeof action === 'function') {\n      return action(dispatch, getState);\n    }\n\n    return next(action);\n  };\n}\n\nmodule.exports = createMiddleware();\n","const createStore = require('./create_store');\nconst applyMiddleware = require('./apply_middleware');\nconst middleware = require('./function_middleware');\n\n// eslint-disable-next-line func-names\n(function(root) {\n  const forExport = { createStore, applyMiddleware, middleware };\n\n  if (typeof exports === 'object' && typeof module === 'object') {\n    module.exports = forExport;\n    // eslint-disable-next-line no-undef\n  } else if (typeof define === 'function' && define.amd) {\n    // eslint-disable-next-line no-undef\n    define([], func);\n  } else if (typeof exports === 'object') {\n    exports.redux = forExport;\n  }\n  // eslint-disable-next-line no-param-reassign\n  root.redux = forExport;\n})((typeof window !== 'undefined' && window) || global);\n"]}