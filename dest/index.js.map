{"version":3,"sources":["create_store.js","apply_middleware.js","function_middleware.js","index.js"],"names":["isFunction","obj","createStore","reducer","initialState","extension","Error","every","item","undefined","applyMiddlewares","state","currentReducer","subscribers","dispatch","action","oldState","forEach","subscriber","getState","subscribe","cb","push","index","indexOf","splice","composeMiddlewares","middlewares","length","reduce","prev","curr","applyMiddleware","args","store","middlewareAPI","payload","middleWaresWithCurrentStore","map","middleware","createMiddleware","next","root","forExport","exports","module","define","amd","func","redux","window","global"],"mappings":"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","file":"index.js","sourceRoot":"../src/store","sourcesContent":["function isFunction(obj) {\n  return typeof obj === 'function';\n}\n\n/**\n * Фнкция для создания редьюсера\n * @param reducer\n * @param initialState: object|function Может быть объектом начального стора или applay middleware\n * @param extension: object|function Может быть объектом начального стора или applay middleware\n * @return {{dispatch(*=): void, getState: (function(): *), subscribe(*=): *}|Function}\n */\nexport default function createStore(reducer, initialState, extension) {\n  if (typeof reducer !== 'function') throw new Error('reducer must be function');\n\n  if ([initialState, extension].every(item => isFunction(item))) {\n    throw new Error('can be only one store extension as function');\n  }\n\n  if (isFunction(initialState) && extension === undefined) {\n    const applyMiddlewares = initialState;\n    const preloadState = undefined;\n    return applyMiddlewares(createStore, reducer, preloadState);\n  }\n\n  let state = initialState;\n  const currentReducer = reducer;\n\n  const subscribers = [];\n  return {\n    dispatch(action) {\n      const oldState = state;\n      state = currentReducer(state, action);\n\n      if (state === oldState) {\n        throw new Error('reducer must return copy of object');\n      }\n\n      subscribers.forEach(subscriber => {\n        subscriber(state);\n      });\n    },\n\n    getState: () => state,\n\n    subscribe(cb) {\n      subscribers.push(cb);\n\n      return () => {\n        const index = subscribers.indexOf(cb);\n\n        if (index >= 0) {\n          subscribers.splice(index, 1);\n        }\n      };\n    },\n  };\n}\n","/**\n * Фнкция для создания цепочки из middlewares\n * @param middlewares bиспользуемые в приложении\n * @return function Вернет функцию которая создаст цепочку\n */\nfunction composeMiddlewares(...middlewares) {\n  if (!middlewares.length) {\n    throw new Error('no pass one middleware');\n  }\n\n  if (middlewares.length === 1) {\n    return middlewares[0];\n  }\n\n  return middlewares.reduce((prev, curr) => (...args) => prev(curr(...args)));\n}\n\n/**\n * Функция для создания цепочки из middlewares,\n * @param middlewares принимает в качестве аргументов middlewares\n * @return {function(*, *=, ...[*]): {dispatch: *, store: *}} Возврщает функцию для стора\n */\nexport default function applyMiddleware(...middlewares) {\n  /**\n   * Фнкция, которая исполняется непосредственно в сторе\n   * @param createStore функция создания стора\n   * @param reducer\n   * @param args начальное состояние\n   * @return {{dispatch: *, store: *}}\n   */\n  return (createStore, reducer, ...args) => {\n    const store = createStore(reducer, ...args);\n\n    let dispatch = () => {\n      throw new Error('dispatch called too early');\n    };\n\n    const middlewareAPI = {\n      getState: store.getState,\n      dispatch: (action, ...payload) => dispatch(action, ...payload),\n    };\n\n    const middleWaresWithCurrentStore = middlewares.map(middleware => middleware(middlewareAPI));\n\n    dispatch = composeMiddlewares(...middleWaresWithCurrentStore)(store.dispatch);\n\n    return {\n      store,\n      dispatch,\n    };\n  };\n}\n","function createMiddleware() {\n  return ({ dispatch, getState }) => next => action => {\n    if (typeof action === 'function') {\n      return action(dispatch, getState);\n    }\n\n    return next(action);\n  };\n}\n\nexport default createMiddleware();\n","import createStore from './create_store';\nimport applyMiddleware from './apply_middleware';\nimport middleware from './function_middleware';\n\n// eslint-disable-next-line func-names\n(function(root) {\n  const forExport = { createStore, applyMiddleware, middleware };\n\n  if (typeof exports === 'object' && typeof module === 'object') {\n    module.exports = forExport;\n    // eslint-disable-next-line no-undef\n  } else if (typeof define === 'function' && define.amd) {\n    // eslint-disable-next-line no-undef\n    define([], func);\n  } else if (typeof exports === 'object') {\n    exports.redux = forExport;\n  }\n  // eslint-disable-next-line no-param-reassign\n  root.redux = forExport;\n})((typeof window !== 'undefined' && window) || global);\n"]}